# The Apple M1

Historically our dev workflows and setup have revolved around x86 architecture. The M1 is 
new and can be a bit of a problem setting up. As you work through this process, please update
this doc with quirks, tricks, or best practices you come across.

!!! warning

    As of the commit of this documentation, the following blog is the best place to start. Forge your own path at your
    and your colleagues risk. Right now it is very easy to get into a state where confusing things happen.

1. Colin's blog post [Python, Django, and React Development on Apple Silicon](https://www.caktusgroup.com/blog/2021/04/02/python-django-react-development-apple-silicon/ "Python Django React Apple Silicon")


## Currently Identified Additions to .zshrc for M1 Users

```
alias ibrew='arch -x86_64 /usr/local/bin/brew'

export NVM_DIR="$HOME/.nvm"
[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && . "/opt/homebrew/opt/nvm/nvm.sh"  # This loads nvm
[ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && . "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  # This loads nvm bash_completion

autoload -U add-zsh-hook
load-nvmrc() {
  local node_version="$(nvm version)"
  local nvmrc_path="$(nvm_find_nvmrc)"

  if [ -n "$nvmrc_path" ]; then
    local nvmrc_node_version=$(nvm version "$(cat "${nvmrc_path}")")

    if [ "$nvmrc_node_version" = "N/A" ]; then
      nvm install
    elif [ "$nvmrc_node_version" != "$node_version" ]; then
      nvm use
    fi
  elif [ "$node_version" != "$(nvm version default)" ]; then
    echo "Reverting to nvm default version"
    nvm use default
  fi
}
add-zsh-hook chpwd load-nvmrc
load-nvmrc

# Add homebrew to path
export PATH="/opt/homebrew/bin:$PATH"

# C-lib complication flags
export LDFLAGS="-L$(brew --prefix openssl)/lib -L$(brew --prefix zlib)/lib"
export CPPFLAGS="-I$(brew --prefix openssl)/include -I$(brew --prefix zlib)/include"

# Hook in direnv
eval "$(direnv hook zsh)"

eval "$(pyenv init -)"
```
